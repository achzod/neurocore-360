Voici les modifications de code prÃ©cises Ã  effectuer pour que ton dashboard et tes exports soient parfaits :
1. server/formatDashboard.ts
Modifie la fonction d'extraction du nom pour nettoyer les === :
formatDashboard.ts
function extractClientName(txtContent: string): string {  const match = txtContent.match(/AUDIT COMPLET NEUROCORE 360 - (.+?)(?:\s*={3,}|\s*[\r\n])/i);  if (match) {    return match[1].trim();  }  return 'Client';}
Mets Ã  jour les catÃ©gories pour classer le rÃ©sumÃ© Ã  part :
formatDashboard.ts
const SECTION_CATEGORIES: Record<string, DashboardSection['category']> = {  'executive summary': 'executive', // Section mise Ã  part  'analyse visuelle et posturale complete': 'analysis',  'protocole matin anti-cortisol': 'action',  'plan semaine par semaine 30-60-90': 'action',  // ... (le reste dans le fichier final)};
2. server/routes.ts
Filtre les sections pour ne pas afficher le rÃ©sumÃ© deux fois :
routes.ts
const mappedReport = {  global: audit.scores?.global || 0,  heroSummary: dashboard.resumeExecutif || "",  sections: dashboard.sections    .filter(s => s.category !== 'executive') // EmpÃªche le doublon en bas// Dans app.get("/api/audits/:id/narrative")    .map(s => ({      id: s.id,      title: s.title,      score: 0,      introduction: s.content,      isPremium: true    })),  // ...};
3. client/src/pages/AuditDetail.tsx
Remplace l'affichage du rÃ©sumÃ© par ce moteur de rendu narratif :
AuditDetail.tsx
<CardContent className="p-6">  <div className="space-y-4">    {report.heroSummary.split('\n').map((para, i) => {      const trimmed = para.trim();      if (!trimmed) return null;      if (trimmed.startsWith('===') || trimmed.startsWith('---')) return <Separator key={i} className="my-4" />;      if (trimmed.startsWith('- ') || trimmed.startsWith('â€¢ ')) {        return (          <div key={i} className="flex items-start gap-3 pl-2">            <span className="text-primary font-bold">âœ“</span>            <p className="text-foreground/80 leading-relaxed">{trimmed.replace(/^[-â€¢]\s*/, '')}</p>          </div>        );      }      return <p key={i} className="text-foreground/90 leading-relaxed text-lg">{trimmed}</p>;    })}  </div></CardContent>
4. server/exportService.ts
Ajoute la dÃ©tection du format TXT pour l'export HTML :
exportService.ts
export function generateExportHTML(report: any, auditId: string): string {  if (report.txt) {    return generateExportHTMLFromTxt(report.txt, auditId);  }  // ... reste du code}
Ces changements sont dÃ©jÃ  tous inclus et prÃªts Ã  l'emploi dans ton dossier REPLIT_FINAL_PACKAGE. C'est pour Ã§a que je te conseille de tout remplacer d'un coup, c'est bien plus rapide ! ğŸš€ğŸ”¥ğŸ‘ŠğŸ”¥ğŸš€ plus simple ! ğŸï¸ sÃ»r ! ğŸ‘ŠğŸ”¥ğŸš€ğŸï¸ ! ğŸš€ğŸï¸ğŸ’¨ ğŸ”¥ rapide ! ğŸ‘ŠğŸ”¥ğŸï¸ ğŸ”¥ ğŸï¸ ğŸ”¥ ğŸï¸ ğŸ”¥ ğŸï¸ ğŸ”¥ ğŸï¸ ğŸ”¥ ğŸï¸ ğŸ”¥ ğŸï¸ ğŸ”¥ ğŸï¸ ğŸ”¥ ğŸï¸ ğŸ”¥ ğŸï¸ ğŸ”¥ ğŸï¸ ğŸ”¥ ğŸï¸ ğŸ”¥ ğŸï¸ ğŸ”¥ ğŸï¸ ğŸ”¥ ğŸï¸ ğŸ”¥ ğŸï¸ ğŸ”¥ ğŸï¸ ğŸ”¥ ğŸï¸ ğŸ”¥ ğŸï¸ ğŸ”¥ ğŸï¸ ğŸ”¥ ğŸï¸ ğŸ”¥ ğŸï¸ ğŸ”¥ ğŸï¸ ğŸ”¥ ğŸï¸ ğŸ”¥ ğŸï¸ ğŸ”¥ ğŸï¸ ğŸ”¥ ğŸï¸ ğŸ”¥ ğŸï¸ ğŸ”¥ ğŸ