import{u as m,bG as d,r as u,aF as x,j as e,B as p,bC as h,aV as j,aW as g}from"./vendor-C1l_5e97.js";import{B as f}from"./button-DpFebx5z.js";import{C as v,a as b,b as y,c as N}from"./card-CFv6635F.js";import{I as C}from"./input-Ci_LweTY.js";import{L as S}from"./label-CixSLeDL.js";import{u as w,H as L,a as E}from"./index-Cv9frRJP.js";function A(){const[,r]=m(),n=d(),{toast:l}=w(),[a,o]=u.useState(""),i=new URLSearchParams(n).get("next")||"",s=x({mutationFn:async()=>E("POST","/api/auth/magic-link",{email:a}),onSuccess:()=>{localStorage.setItem("neurocore_email",a),i?localStorage.setItem("apexlabs_post_login_redirect",i):localStorage.removeItem("apexlabs_post_login_redirect"),r("/auth/check-email")},onError:()=>{l({title:"Erreur",description:"Impossible d'envoyer le lien. VÃ©rifie ton email.",variant:"destructive"})}}),c=t=>{t.preventDefault(),a&&a.includes("@")&&s.mutate()};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(L,{}),e.jsx("div",{className:"mx-auto max-w-md px-4 py-20",children:e.jsx(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:e.jsxs(v,{children:[e.jsxs(b,{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-sm bg-primary/10",children:e.jsx(h,{className:"h-8 w-8 text-primary"})}),e.jsx(y,{className:"text-2xl",children:"Acces a ton espace"}),e.jsx("p",{className:"mt-2 text-muted-foreground",children:"Entre ton email pour recevoir un lien d'acces unique. Aucun mot de passe requis."})]}),e.jsxs(N,{children:[e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"email",children:"Adresse email"}),e.jsx(C,{id:"email",type:"email",placeholder:"ton@email.com",value:a,onChange:t=>o(t.target.value),required:!0,"data-testid":"input-login-email"})]}),e.jsx(f,{type:"submit",className:"w-full",disabled:s.isPending,"data-testid":"button-send-magic-link",children:s.isPending?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"mr-2 h-4 w-4 animate-spin"}),"Envoi en cours..."]}):e.jsxs(e.Fragment,{children:["Recevoir le lien d'acces",e.jsx(g,{className:"ml-2 h-4 w-4"})]})})]}),e.jsxs("div",{className:"mt-6 text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Lien valable 60 minutes. Tu accedes a tous tes dashboards depuis un seul lien."}),e.jsx("a",{href:"/audit-complet/questionnaire",className:"mt-2 inline-flex text-sm font-medium text-primary hover:underline","data-testid":"link-start-audit",children:"Commencer un audit"})]})]})]})})})]})}export{A as default};
